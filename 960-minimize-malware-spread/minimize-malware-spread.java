class Solution {
    public class Node {
        int val;
        int rank;
        Node parent;
    }

    HashMap<Integer, Node> map = new HashMap<>();

    public void createSet(int v1) {
        Node nn = new Node();
        nn.val = v1;
        nn.rank = 0;
        nn.parent = nn;
        map.put(v1, nn);
    }

    public int find(int v) {
        Node nn = map.get(v);
        return find(nn).val;
    }

    public Node find(Node nn) {
        if (nn.parent == nn) {
            return nn;
        }
        Node rn = find(nn.parent);
        nn.parent = rn;
        return rn;
    }

    public void union(int v1, int v2) {
        Node nn1 = map.get(v1);
        Node nn2 = map.get(v2);
        Node rn1 = find(nn1);
        Node rn2 = find(nn2);
        if (rn1.rank == rn2.rank) {
            rn1.parent = rn2;
            rn2.rank++;
        } else if (rn1.rank > rn2.rank) {
            rn2.parent = rn1;
        } else {
            rn1.parent = rn2;
        }
    }

    public int minMalwareSpread(int[][] graph, int[] initial) {
        int n = graph.length;
        for (int i = 0; i < n; i++) {
            createSet(i);
        }

        for (int i = 0; i < n; i++) {
            for (int j = 0; j < n; j++) {
                if (graph[i][j] == 1) {
                    union(i, j);
                }
            }
        }

        int[] infected = new int[n];
        for (int el : initial) {
            infected[find(el)]++;
        }

        int[] size = new int[n];
        for (int i = 0; i < n; i++) {
            size[find(i)]++;
        }

        Arrays.sort(initial);
        int ans = initial[0];
        int mxsave = 0;
        for (int el : initial) {
            int node = find(el);
            if (infected[node] == 1) {
                if (size[node] > mxsave) {
                    ans = el;
                    mxsave = size[node];
                }
            }

        }
        return ans;
    }
}